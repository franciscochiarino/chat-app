{"ast":null,"code":"import _toArray from\"/home/fran/Documents/chat-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toArray\";import _toConsumableArray from\"/home/fran/Documents/chat-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/home/fran/Documents/chat-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import io from'socket.io-client';import InfoBar from'../infobar/InfoBar';import Input from'../input/Input';import Messages from'../messages/Messages';var socket=io();export default function Chat(_ref){var name=_ref.name,room=_ref.room,chatWindow=_ref.chatWindow,setChatWindow=_ref.setChatWindow;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),text=_useState2[0],setText=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),messages=_useState4[0],setMessages=_useState4[1];useEffect(function(){// Emit JOIN\nsocket.emit('join',{name:name,room:room},function(error){if(error){sessionStorage.removeItem('name');alert(error);window.location.reload();}});return function(){// Emit DISCONNECT\nsocket.emit('disconnect');// Turn off this socket\nsocket.off();};},[name,room]);useEffect(function(){// Recieve MESSAGE\nsocket.on('message',function(message){setMessages(function(messages){return[].concat(_toConsumableArray(messages),[message]);});});},[]);var sendMessage=function sendMessage(e){e.preventDefault();if(text){// Emit SENDMESSAGE\nsocket.emit('sendMessage',text,function(){setText('');});}if(messages.length>=50){removeFirst();}};var removeFirst=function removeFirst(){var _messages=_toArray(messages),first=_messages[0],rest=_messages.slice(1);return setMessages(rest);};return/*#__PURE__*/React.createElement(\"div\",{className:\"outer-container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"inner-container\"},/*#__PURE__*/React.createElement(InfoBar,{room:room,chatWindow:chatWindow,setChatWindow:setChatWindow}),/*#__PURE__*/React.createElement(Messages,{messages:messages,name:name}),/*#__PURE__*/React.createElement(Input,{text:text,setText:setText,sendMessage:sendMessage})));}","map":{"version":3,"sources":["/home/fran/Documents/chat-app/client/src/components/chat/Chat.js"],"names":["React","useEffect","useState","io","InfoBar","Input","Messages","socket","Chat","name","room","chatWindow","setChatWindow","text","setText","messages","setMessages","emit","error","sessionStorage","removeItem","alert","window","location","reload","off","on","message","sendMessage","e","preventDefault","length","removeFirst","first","rest"],"mappings":"6cAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CACA,MAAOC,CAAAA,EAAP,KAAe,kBAAf,CACA,MAAOC,CAAAA,OAAP,KAAoB,oBAApB,CACA,MAAOC,CAAAA,KAAP,KAAkB,gBAAlB,CACA,MAAOC,CAAAA,QAAP,KAAqB,sBAArB,CAEA,GAAMC,CAAAA,MAAM,CAAGJ,EAAE,EAAjB,CAEA,cAAe,SAASK,CAAAA,IAAT,MAAyD,IAAzCC,CAAAA,IAAyC,MAAzCA,IAAyC,CAAnCC,IAAmC,MAAnCA,IAAmC,CAA7BC,UAA6B,MAA7BA,UAA6B,CAAjBC,aAAiB,MAAjBA,aAAiB,eAC9CV,QAAQ,CAAC,EAAD,CADsC,wCAC/DW,IAD+D,eACzDC,OADyD,8BAEtCZ,QAAQ,CAAC,EAAD,CAF8B,yCAE/Da,QAF+D,eAErDC,WAFqD,eAItEf,SAAS,CAAC,UAAM,CAEd;AACAM,MAAM,CAACU,IAAP,CAAY,MAAZ,CAAoB,CAACR,IAAI,CAAJA,IAAD,CAAOC,IAAI,CAAJA,IAAP,CAApB,CAAkC,SAACQ,KAAD,CAAW,CAC3C,GAAIA,KAAJ,CAAW,CACTC,cAAc,CAACC,UAAf,CAA0B,MAA1B,EACAC,KAAK,CAACH,KAAD,CAAL,CACAI,MAAM,CAACC,QAAP,CAAgBC,MAAhB,GACD,CACF,CAND,EAQA,MAAO,WAAM,CACX;AACAjB,MAAM,CAACU,IAAP,CAAY,YAAZ,EACA;AACAV,MAAM,CAACkB,GAAP,GACD,CALD,CAMD,CAjBQ,CAiBN,CAAChB,IAAD,CAAOC,IAAP,CAjBM,CAAT,CAmBAT,SAAS,CAAC,UAAM,CACd;AACAM,MAAM,CAACmB,EAAP,CAAU,SAAV,CAAqB,SAACC,OAAD,CAAa,CAChCX,WAAW,CAAC,SAACD,QAAD,qCAAkBA,QAAlB,GAA4BY,OAA5B,IAAD,CAAX,CACD,CAFD,EAGD,CALQ,CAKN,EALM,CAAT,CAOA,GAAMC,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,CAAAC,CAAC,CAAI,CACvBA,CAAC,CAACC,cAAF,GACA,GAAIjB,IAAJ,CAAU,CACR;AACAN,MAAM,CAACU,IAAP,CAAY,aAAZ,CAA2BJ,IAA3B,CAAiC,UAAM,CACrCC,OAAO,CAAC,EAAD,CAAP,CACD,CAFD,EAGD,CACD,GAAIC,QAAQ,CAACgB,MAAT,EAAmB,EAAvB,CAA2B,CACzBC,WAAW,GACZ,CACF,CAXD,CAaA,GAAMA,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,EAAM,wBACCjB,QADD,EACjBkB,KADiB,cACPC,IADO,oBAExB,MAAOlB,CAAAA,WAAW,CAACkB,IAAD,CAAlB,CACD,CAHD,CAKA,mBACE,2BAAK,SAAS,CAAC,iBAAf,eACE,2BAAK,SAAS,CAAC,iBAAf,eACE,oBAAC,OAAD,EAAS,IAAI,CAAExB,IAAf,CAAqB,UAAU,CAAEC,UAAjC,CAA6C,aAAa,CAAEC,aAA5D,EADF,cAEE,oBAAC,QAAD,EAAU,QAAQ,CAAEG,QAApB,CAA8B,IAAI,CAAEN,IAApC,EAFF,cAGE,oBAAC,KAAD,EAAO,IAAI,CAAEI,IAAb,CAAmB,OAAO,CAAEC,OAA5B,CAAqC,WAAW,CAAEc,WAAlD,EAHF,CADF,CADF,CASD","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport io from 'socket.io-client';\nimport InfoBar from '../infobar/InfoBar';\nimport Input from '../input/Input';\nimport Messages from '../messages/Messages';\n\nconst socket = io();\n\nexport default function Chat({ name, room, chatWindow, setChatWindow }) {\n  const [text, setText] = useState('');\n  const [messages, setMessages] = useState([]);\n\n  useEffect(() => {\n\n    // Emit JOIN\n    socket.emit('join', {name, room}, (error) => {\n      if (error) {\n        sessionStorage.removeItem('name');\n        alert(error);\n        window.location.reload()\n      }\n    });\n\n    return () => {\n      // Emit DISCONNECT\n      socket.emit('disconnect');\n      // Turn off this socket\n      socket.off();\n    }\n  }, [name, room])\n\n  useEffect(() => {\n    // Recieve MESSAGE\n    socket.on('message', (message) => {\n      setMessages((messages) => [...messages, message]);\n    })\n  }, []);\n\n  const sendMessage = e => {\n    e.preventDefault();\n    if (text) {\n      // Emit SENDMESSAGE\n      socket.emit('sendMessage', text, () => {\n        setText('');\n      })\n    }\n    if (messages.length >= 50) {\n      removeFirst();\n    } \n  };\n\n  const removeFirst = () => {\n    const [first, ...rest] = messages;\n    return setMessages(rest);\n  };\n\n  return (\n    <div className=\"outer-container\">\n      <div className=\"inner-container\">\n        <InfoBar room={room} chatWindow={chatWindow} setChatWindow={setChatWindow} />\n        <Messages messages={messages} name={name} />\n        <Input text={text} setText={setText} sendMessage={sendMessage} />\n      </div>\n    </div>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}